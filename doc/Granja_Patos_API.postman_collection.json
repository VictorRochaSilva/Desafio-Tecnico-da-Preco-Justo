{
  "info": {
    "_postman_id": "granja-patos-api",
    "name": "Granja de Patos - API Completa",
    "description": "Collection completa para a API de Gerenciamento de Granja de Patos com todas as funcionalidades implementadas:\n\n‚úÖ **Autentica√ß√£o JWT**\n‚úÖ **Gerenciamento de Patos** (com rastreamento de linhagem)\n‚úÖ **Gerenciamento de Clientes** (com elegibilidade para desconto)\n‚úÖ **Gerenciamento de Vendedores**\n‚úÖ **Opera√ß√µes de Venda** (com c√°lculo autom√°tico de desconto)\n‚úÖ **Relat√≥rios Excel** (Apache POI)\n‚úÖ **Migra√ß√µes de Banco** (Flyway)\n\n**Funcionalidades Especiais:**\n- Desconto autom√°tico de 20% para clientes eleg√≠veis\n- Rastreamento de linhagem de patos pelo nome da m√£e\n- Gera√ß√£o de relat√≥rios Excel profissionais\n- Controle de acesso baseado em roles\n- Valida√ß√£o autom√°tica de dados\n\n**Tecnologias:** Spring Boot 3.2.0, PostgreSQL, Flyway, Apache POI, JWT",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "granja-system"
  },
  "item": [
    {
      "name": "üîê Autentica√ß√£o",
      "description": "Endpoints para autentica√ß√£o e gerenciamento de usu√°rios",
      "item": [
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"admin\",\n    \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/login",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Autentica√ß√£o de usu√°rio para obter token JWT"
          },
          "response": [],
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.collectionVariables.set('auth_token', response.token);",
                  "    console.log('Token JWT armazenado:', response.token);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Criar Usu√°rio Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"admin\",\n    \"name\": \"Administrador\",\n    \"role\": \"ADMIN\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/auth/users/create?password=admin123",
              "host": ["{{base_url}}"],
              "path": ["api", "auth", "users", "create"],
              "query": [
                {
                  "key": "password",
                  "value": "admin123"
                }
              ]
            },
            "description": "Criar usu√°rio administrador inicial (executar apenas uma vez)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "ü¶Ü Gerenciamento de Patos",
      "description": "Opera√ß√µes CRUD para gerenciamento de patos individuais com rastreamento de linhagem",
      "item": [
        {
          "name": "Listar Todos os Patos",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/ducks",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks"]
            },
            "description": "Lista todos os patos cadastrados no sistema"
          },
          "response": []
        },
        {
          "name": "Obter Pato por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/ducks/1",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks", "1"]
            },
            "description": "Obt√©m um pato espec√≠fico pelo ID"
          },
          "response": []
        },
        {
          "name": "Criar Novo Pato",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Donald Duck\",\n    \"motherId\": null,\n    \"price\": 150.00,\n    \"status\": \"AVAILABLE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ducks",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks"]
            },
            "description": "Cria um novo pato no sistema. O campo `motherName` √© opcional para rastreamento de linhagem"
          },
          "response": []
        },
        {
          "name": "Criar Pato com Linhagem",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Duckling 1\",\n    \"motherId\": 1,\n    \"price\": 120.00,\n    \"status\": \"AVAILABLE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ducks",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks"]
            },
            "description": "Cria um pato filhote especificando o nome da m√£e para rastreamento de linhagem"
          },
          "response": []
        },
        {
          "name": "Atualizar Pato",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Donald Duck Atualizado\",\n    \"motherId\": null,\n    \"price\": 180.00,\n    \"status\": \"AVAILABLE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/ducks/1",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks", "1"]
            },
            "description": "Atualiza os dados de um pato existente"
          },
          "response": []
        },
        {
          "name": "Remover Pato",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/ducks/1",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks", "1"]
            },
            "description": "Remove um pato do sistema (n√£o pode remover patos vendidos)"
          },
          "response": []
        },
        {
          "name": "Filtrar Patos por Status",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/ducks/status/AVAILABLE",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks", "status", "AVAILABLE"]
            },
            "description": "Filtra patos por status: AVAILABLE, SOLD, RESERVED"
          },
          "response": []
        },
        {
          "name": "Patos Dispon√≠veis para Venda",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/ducks/available",
              "host": ["{{base_url}}"],
              "path": ["api", "ducks", "available"]
            },
            "description": "Lista apenas patos dispon√≠veis para venda (status AVAILABLE)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üë• Gerenciamento de Clientes",
      "description": "Opera√ß√µes CRUD para gerenciamento de clientes com elegibilidade para desconto",
      "item": [
        {
          "name": "Listar Todos os Clientes",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/customers",
              "host": ["{{base_url}}"],
              "path": ["api", "customers"]
            },
            "description": "Lista todos os clientes cadastrados no sistema"
          },
          "response": []
        },
        {
          "name": "Obter Cliente por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/customers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "customers", "1"]
            },
            "description": "Obt√©m um cliente espec√≠fico pelo ID"
          },
          "response": []
        },
        {
          "name": "Criar Cliente com Desconto",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Carlos Ferreira\",\n    \"cpf\": \"111.222.333-44\",\n    \"phone\": \"(11) 99999-1111\",\n    \"address\": \"Rua A, 123 - S√£o Paulo/SP\",\n    \"discountEligible\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/customers",
              "host": ["{{base_url}}"],
              "path": ["api", "customers"]
            },
            "description": "Cria um cliente eleg√≠vel para desconto de 20% nas compras"
          },
          "response": []
        },
        {
          "name": "Criar Cliente sem Desconto",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Ana Costa\",\n    \"cpf\": \"555.666.777-88\",\n    \"phone\": \"(21) 88888-2222\",\n    \"address\": \"Av. B, 456 - Rio de Janeiro/RJ\",\n    \"discountEligible\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/customers",
              "host": ["{{base_url}}"],
              "path": ["api", "customers"]
            },
            "description": "Cria um cliente n√£o eleg√≠vel para desconto"
          },
          "response": []
        },
        {
          "name": "Atualizar Cliente",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Carlos Ferreira Atualizado\",\n    \"cpf\": \"111.222.333-44\",\n    \"phone\": \"(11) 99999-9999\",\n    \"address\": \"Rua Nova, 456 - S√£o Paulo/SP\",\n    \"discountEligible\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/customers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "customers", "1"]
            },
            "description": "Atualiza os dados de um cliente existente"
          },
          "response": []
        },
        {
          "name": "Remover Cliente",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/customers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "customers", "1"]
            },
            "description": "Remove um cliente do sistema"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üë®‚Äçüíº Gerenciamento de Vendedores",
      "description": "Opera√ß√µes CRUD para gerenciamento de vendedores com m√©tricas de performance",
      "item": [
        {
          "name": "Listar Todos os Vendedores",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sellers",
              "host": ["{{base_url}}"],
              "path": ["api", "sellers"]
            },
            "description": "Lista todos os vendedores cadastrados no sistema"
          },
          "response": []
        },
        {
          "name": "Obter Vendedor por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sellers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sellers", "1"]
            },
            "description": "Obt√©m um vendedor espec√≠fico pelo ID"
          },
          "response": []
        },
        {
          "name": "Criar Novo Vendedor",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Jo√£o Silva\",\n    \"cpf\": \"123.456.789-01\",\n    \"employeeId\": \"V001\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/sellers",
              "host": ["{{base_url}}"],
              "path": ["api", "sellers"]
            },
            "description": "Cria um novo vendedor no sistema. CPF e matr√≠cula devem ser √∫nicos"
          },
          "response": []
        },
        {
          "name": "Atualizar Vendedor",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Jo√£o Silva Atualizado\",\n    \"cpf\": \"123.456.789-01\",\n    \"employeeId\": \"V001\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/sellers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sellers", "1"]
            },
            "description": "Atualiza os dados de um vendedor existente"
          },
          "response": []
        },
        {
          "name": "Remover Vendedor",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sellers/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sellers", "1"]
            },
            "description": "Remove um vendedor do sistema (n√£o pode remover vendedores com vendas)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üí∞ Opera√ß√µes de Venda",
      "description": "Opera√ß√µes para registro e gerenciamento de vendas com c√°lculo autom√°tico de desconto",
      "item": [
        {
          "name": "Listar Todas as Vendas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sales",
              "host": ["{{base_url}}"],
              "path": ["api", "sales"]
            },
            "description": "Lista todas as vendas registradas no sistema"
          },
          "response": []
        },
        {
          "name": "Obter Venda por ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sales/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sales", "1"]
            },
            "description": "Obt√©m uma venda espec√≠fica pelo ID"
          },
          "response": []
        },
        {
          "name": "Registrar Nova Venda",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"duckId\": 1,\n    \"customerId\": 1,\n    \"sellerId\": 1,\n    \"originalPrice\": 150.00\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/sales",
              "host": ["{{base_url}}"],
              "path": ["api", "sales"]
            },
            "description": "Registra uma nova venda. O desconto de 20% √© aplicado automaticamente para clientes eleg√≠veis"
          },
          "response": []
        },
        {
          "name": "Vendas por Cliente",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sales/customer/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sales", "customer", "1"]
            },
            "description": "Lista todas as vendas de um cliente espec√≠fico"
          },
          "response": []
        },
        {
          "name": "Vendas por Vendedor",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/sales/seller/1",
              "host": ["{{base_url}}"],
              "path": ["api", "sales", "seller", "1"]
            },
            "description": "Lista todas as vendas de um vendedor espec√≠fico"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üìä Relat√≥rios Excel",
      "description": "Endpoints para gera√ß√£o e download de relat√≥rios profissionais em Excel usando Apache POI",
      "item": [
        {
          "name": "Relat√≥rio de Vendas",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/reports/sales?startDate=2024-01-01T00:00:00&endDate=2024-12-31T23:59:59",
              "host": ["{{base_url}}"],
              "path": ["api", "reports", "sales"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-01-01T00:00:00",
                  "description": "Data de in√≠cio do per√≠odo (formato ISO)"
                },
                {
                  "key": "endDate",
                  "value": "2024-12-31T23:59:59",
                  "description": "Data de fim do per√≠odo (formato ISO)"
                }
              ]
            },
            "description": "Gera e faz download de relat√≥rio de vendas em Excel com:\n\n**Colunas:**\n- Nome do Pato\n- Status\n- Cliente\n- Tipo Cliente (Com/Sem Desconto)\n- Valor\n- Data/Hora\n- Vendedor\n\n**Layout:**\n- Header com t√≠tulo e per√≠odo\n- Data de gera√ß√£o\n- Resumo com totais\n- Formata√ß√£o profissional"
          },
          "response": []
        },
        {
          "name": "Relat√≥rio de Ranking de Vendedores",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{auth_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/reports/seller-ranking?startDate=2024-01-01T00:00:00&endDate=2024-12-31T23:59:59",
              "host": ["{{base_url}}"],
              "path": ["api", "reports", "seller-ranking"],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-01-01T00:00:00",
                  "description": "Data de in√≠cio do per√≠odo (formato ISO)"
                },
                {
                  "key": "endDate",
                  "value": "2024-12-31T23:59:59",
                  "description": "Data de fim do per√≠odo (formato ISO)"
                }
              ]
            },
            "description": "Gera e faz download de relat√≥rio de ranking de vendedores em Excel com:\n\n**Colunas:**\n- Posi√ß√£o\n- Vendedor\n- Total de Vendas\n- Receita Total\n- Ticket M√©dio\n- CPF\n- Matr√≠cula\n\n**Layout:**\n- Header com t√≠tulo e per√≠odo\n- Data de gera√ß√£o\n- Ranking ordenado por receita\n- Resumo com totais\n- Formata√ß√£o profissional"
          },
          "response": []
        }
      ]
    },
    {
      "name": "üóÑÔ∏è Gerenciamento de Banco (Flyway)",
      "description": "Comandos para gerenciar migra√ß√µes de banco de dados usando Flyway",
      "item": [
        {
          "name": "Verificar Status das Migra√ß√µes",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/health",
              "host": ["{{base_url}}"],
              "path": ["api", "health"]
            },
            "description": "Verifica o status da aplica√ß√£o e das migra√ß√µes Flyway\n\n**Comandos Maven:**\n```bash\n# Verificar status\nmvn flyway:info\n\n# Executar migra√ß√µes\nmvn flyway:migrate\n\n# Limpar banco (desenvolvimento)\nmvn flyway:clean\n```"
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Verificar se o token est√° definido para endpoints protegidos",
          "if (pm.request.headers.has('Authorization') && !pm.collectionVariables.get('auth_token')) {",
          "    console.warn('Token JWT n√£o encontrado. Execute o endpoint de Login primeiro.');",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8080",
      "type": "string",
      "description": "URL base da API"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string",
      "description": "Token JWT para autentica√ß√£o (preenchido automaticamente ap√≥s login)"
    }
  ]
}
